# 博弈过程

## 一、第一种情况： $S_1$ =150， $\delta=2$ 

### (1) 第一轮非合作博弈

第一轮的关键企业1为节点28，所有下标为1的变量都用节点28对应的值，假定 $\gamma_1$ 已知， $q_{1,1}$ 为决策变量

 $I=0.2$ ； $E=NT=2250$ ； $F=0.8$ ； $G=70$ 

第一步：先构建节点28的碳排放成本函数：

 $C_{1,1}=\left[\mu_1\left(q_{1,1}+r_1\right)\right]+\left[\frac{I}{2}\left(e_1 - q_{1,1}\right)^2\right] - \frac{\gamma_1 S_1}{e_1}\left(e_1 - q_{1,1}\right) \tag{13}$ 

第二步：构建其他未得到补贴的企业的碳排放成本函数：

 $C_{i,1}=\left[\mu_i\left(q_{i,1}+r_i\right)\right]+\left[\frac{I}{2}\left(e_i - q_{i,1}\right)^2\right],\ i=2,3,\cdots,N \tag{14}$ 

第三步：在整个碳排放网络共享的碳排放约束下：

 $\sum_{i=1}^{N}(q_{i,1}+r_i) \leq E \tag{15}$ 

构造每个企业的拉格朗日函数：

 $L_i = C_{i,1}\left(q_{i,1}\right) + \lambda_i \left(E - \sum_{i=1}^{N}\left(q_{i,1}+r_i\right)\right),\ \lambda_i \geq 0, i=1,2,\cdots,N$ 

求每个企业的一阶条件（30个式子）：

 $\frac{\partial C_{i,1}\left(q_{i,1}\right)}{\partial q_{i,1}} - \theta_1 = 0,\ i=1,2,\cdots,N \tag{16}$ 

第四步：得到每个企业的反应函数，联立约束条件求解 $\theta_1$ 并得到 $q_{1,1}^*$ ，将其看作关于 $\gamma_1$ 的函数，即 $q_1\left(\gamma_1\right)$ 

### (2) 第一轮合作博弈

第一步：构建纳什讨价还价目标函数：其中 $\alpha_1=0.43$ 

 $\max_{0<\gamma_1<1} B(\gamma_1) = \left[\frac{\gamma_1 S_1}{e_1}\left(e_1 - q_1\left(\gamma_1\right)\right)\right]^{\alpha_1} \left[\delta \gamma_1 S_1 + \eta_1\left(1 - \gamma_1\right)S_1 - \gamma_1 S_1\right]^{1-\alpha_1} \tag{18}$ 

第二步：纳什乘积最大化等价于其对数最大化，在可行域内，令 $\ln B(\gamma_1)$ 对 $\gamma_1$ 求导并令其为0得到一阶条件：

 $\frac{\partial \ln B(\gamma_1)}{\partial \gamma_1} = \alpha_1 \left(\frac{1}{\gamma_1} - \frac{q_1'(\gamma_1)}{e_1 - q_1(\gamma_1)}\right) + \left(1-\alpha_1\right)\frac{\left(\delta - \eta_1 - 1\right)}{\eta_1 + \left(\delta - \eta_1 - 1\right)\gamma_1} = 0 \tag{19}$ 

求得 $\gamma_1^*$ 的值

第三步：将 $\gamma_1^*$ 带回排放量函数 $q_1\left(\gamma_1\right)$ ，得到节点28的决策排放量。其他节点决策不求，后阶段拿到补贴再确定。

### (3) 第二轮非合作博弈

第二阶段初始时，补贴预算剩余 $S_2=(1-\gamma_1^*)S$ ，网络中碳排放量可用总额 $E_2=E-(q_1^* + r_1)$ ，参与博弈的企业只剩下28以外的29个节点。

第二轮的关键企业2为节点23，所有下标为2的变量都用节点23对应的值

第一步：构建节点23的碳排放成本函数

第二步：构建其他未得到补贴的企业的碳排放成本函数

第三步：在整个碳排放网络共享的碳排放约束下

 $s.t. \sum_{i=2}^{N}(q_i + r_i) \leq E_2$ 

求每个企业的一阶条件（29个式子）：

 $\min_{q_{i,2} \geq 0} C_{i,2}\left(q_{i,2}\right),\ i=2,3,\cdots,N \tag{22}$ 

 $\frac{\partial C_{i,2}\left(q_{i,2}\right)}{\partial q_{i,2}} - \theta_2 = 0,\ i=2,\cdots,N$ 

第四步：联立约束条件求解 $\theta_2$ 并得到 $q_{2,2}^*$ ，将其看作关于 $\gamma_2$ 的函数，即 $q_2\left(\gamma_2\right)$ 

### (4) 第二轮合作博弈

第一步：构建纳什讨价还价目标函数，其中 $\alpha_2=0.4$ 

 $\max_{0<\gamma_2<1} B(\gamma_2) = \left[\frac{\gamma_2 S_2}{e_2}\left(e_2 - q_2\left(\gamma_2\right)\right)\right]^{\alpha_2} \left[\delta \gamma_2 S_2 + \eta_2\left(1 - \gamma_2\right)S_2 - \gamma_2 S_2\right]^{1-\alpha_2} \tag{24}$ 

第二步：纳什乘积最大化等价于其对数最大化，在可行域内，令 $\ln B(\gamma_2)$ 对 $\gamma_2$ 求导并令其为0得到一阶条件

求得 $\gamma_2^*$ 的值

第三步：将 $\gamma_2^*$ 带回排放量函数 $q_2\left(\gamma_2\right)$ ，得到节点23的决策排放量，其他节点决策不求，后阶段拿到补贴再确定。

### (5) 最终轮非合作博弈

在此之前一直按照前面的步骤迭代，直到预算S耗尽，进行最后一轮

（假定第3轮分完）本轮关键节点企业能够分得的补贴预算为补贴预算剩余量 $S_3=(1-\gamma_1^*)(1-\gamma_2^*)S$ ，网络中碳排放量可用总额 $E_3=E - \sum_{i=1}^{2}(q_i^* + r_i)$ 。

第一步：先构建节点n的碳排放成本函数：

 $C_{3,3}=\left[\mu_3\left(q_{3,3}+r_3\right)\right]+\left[\frac{I_3}{2}\left(e_3 - q_{3,3}\right)^2\right] - \frac{S_3}{e_3}\left(e_3 - q_{3,3}\right)$ 

第二步：构建其他未得到补贴的企业的碳排放成本函数：

 $C_{i,3}=\left[\mu_i\left(q_{i,3}+r_i\right)\right]+\left[\frac{I_i}{2}\left(e_i - q_{i,3}\right)^2\right],\ i=4,\cdots,N$ 

第三步：在整个碳排放网络共享的碳排放约束下：

 $\sum_{i=3}^{N}(q_{i,3}+r_i) \leq E_3$ 

每个企业都在力求排放成本最小化：

 $\min_{q_{i,3} \geq 0} C_{i,3}\left(q_{i,3}\right),\ i=3,\cdots,N$ 

 $s.t. \sum_{i=3}^{N}(q_{i,3}+r_i) \leq E_3$ 

每个企业的拉格朗日函数：

 $L_i = C_{i,3}\left(q_{i,3}\right) + \theta_3 \left(E_3 - \sum_{i=3}^{N}\left(q_i + r_i\right)\right),\ \tau_i \geq 0, i=3,\cdots,N$ 

每个企业的一阶条件：

 $\frac{\partial C_{i,3}\left(q_{i,3}\right)}{\partial q_{i,3}} - \theta_3 = 0,\ i=3,\cdots,N$ 

得到剩余企业的反应函数，联立约束条件求解得到 $\theta_3$ ，将 $\theta_3$ 带回反应函数得到各自的决策变量 $q_i$ 

汇总的补贴及企业排放量决策如表：

表 序贯博弈结果

||初始补贴预算|初始碳排放总额|该轮关键企业可得补贴预算|企业碳排放决策|
|---|---|---|---|---|
|第一轮|150|2250|||
|第二轮|||||
|…|||||
|最终轮|||||
## 二、第二种情况： $S_1$ =100， $\delta=1.5$ 

## 三、第三种情况： $S_1$ =50， $\delta=1$ 
> （注：文档部分内容可能由 AI 生成）